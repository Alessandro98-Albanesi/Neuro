import itertools
import numpy as np
import open3d as o3d


def Kabsch_Algorithm (A,B):

    
    N = A.shape[1]
    
    T = np.array([[0.0,0.0,0.0,0.0],
                [0.0,0.0,0.0,0.0],
                [0.0,0.0,0.0,0.0],
                [0.0,0.0,0.0,1]])
   
    # calculate centroids
    A_centroid = np.reshape(1/N * (np.sum(A, axis=1)), (3,1))
    B_centroid = np.reshape(1/N * (np.sum(B, axis=1)), (3,1))
    
    # calculate the vectors from centroids
    A_prime = A - A_centroid
    B_prime = B - B_centroid
    
    # rotation estimation
    H = np.matmul(A_prime, B_prime.transpose())
    svd = np.linalg.svd(H)

    # Replace Arun Equation 13 with Fitzpatrick, chapter 8, page 470,
    # to avoid reflections, see issue #19
    X = _fitzpatricks_X(svd)

    # Arun step 5, after equation 13.
    det_X = np.linalg.det(X)

    if det_X < 0 and np.all(np.flip(np.isclose(svd[1], np.zeros((3, 1))))):

        # Don't yet know how to generate test data.
        # If you hit this line, please report it, and save your data.
        raise ValueError("Registration fails as determinant < 0"
                         " and no singular values are close enough to zero")

    if det_X < 0 and np.any(np.isclose(svd[1], np.zeros((3, 1)))):
        # Implement 2a in section VI in Arun paper.
        v_prime = svd[2].transpose()
        v_prime[0][2] *= -1
        v_prime[1][2] *= -1
        v_prime[2][2] *= -1
        X = np.matmul(v_prime, svd[0].transpose())

    # Compute output
    R = X
    t = B_centroid - R @ A_centroid
    T[0:3,0:3] = R
    T[0][-1] = t[0]
    T[1][-1] = t[1]
    T[2][-1] = t[2]
    return R, t, T

def orthogonal_procrustes(fixed, moving):
    """
    Implements point based registration via the Orthogonal Procrustes method.

    Based on Arun's method:

      Least-Squares Fitting of two, 3-D Point Sets, Arun, 1987,
      `10.1109/TPAMI.1987.4767965 <http://dx.doi.org/10.1109/TPAMI.1987.4767965>`_.

    Also see `this <http://eecs.vanderbilt.edu/people/mikefitzpatrick/papers/2009_Medim_Fitzpatrick_TRE_FRE_uncorrelated_as_published.pdf>`_
    and `this <http://tango.andrew.cmu.edu/~gustavor/42431-intro-bioimaging/readings/ch8.pdf>`_.

    :param fixed: point set, N x 3 ndarray
    :param moving: point set, N x 3 ndarray of corresponding points
    :returns: 3x3 rotation ndarray, 3x1 translation ndarray, FRE
    :raises: ValueError
    """

    # This is what we are calculating
    R = np.eye(3)
    T = np.zeros((3, 1))

    # Arun equation 4
    p = np.ndarray.mean(moving, 0)

    # Arun equation 6
    p_prime = np.ndarray.mean(fixed, 0)

    # Arun equation 7
    q = moving - p

    # Arun equation 8
    q_prime = fixed - p_prime

    # Arun equation 11
    H = np.matmul(q.transpose(), q_prime)

    # Arun equation 12
    # Note: numpy factors h = u * np.diag(s) * v
    svd = np.linalg.svd(H)

    # Replace Arun Equation 13 with Fitzpatrick, chapter 8, page 470,
    # to avoid reflections, see issue #19
    X = _fitzpatricks_X(svd)

    # Arun step 5, after equation 13.
    det_X = np.linalg.det(X)

    if det_X < 0 and np.all(np.flip(np.isclose(svd[1], np.zeros((3, 1))))):

        # Don't yet know how to generate test data.
        # If you hit this line, please report it, and save your data.
        raise ValueError("Registration fails as determinant < 0"
                         " and no singular values are close enough to zero")

    if det_X < 0 and np.any(np.isclose(svd[1], np.zeros((3, 1)))):
        # Implement 2a in section VI in Arun paper.
        v_prime = svd[2].transpose()
        v_prime[0][2] *= -1
        v_prime[1][2] *= -1
        v_prime[2][2] *= -1
        X = np.matmul(v_prime, svd[0].transpose())


    # Compute output
    R = X
    tmp = p_prime.transpose() - np.matmul(R, p.transpose())
    T[0][0] = tmp[0]
    T[1][0] = tmp[1]
    T[2][0] = tmp[2]

    return R, tmp, T

def _fitzpatricks_X(svd):
    """This is from Fitzpatrick, chapter 8, page 470.
       it's used in preference to Arun's equation 13,
       X = np.matmul(svd[2].transpose(), svd[0].transpose())
       to avoid reflections.
    """
    VU = np.matmul(svd[2].transpose(), svd[0])
    detVU = np.linalg.det(VU)

    diag = np.eye(3, 3)
    diag[2][2] = detVU

    X = np.matmul(svd[2].transpose(), np.matmul(diag, svd[0].transpose()))
    return X

def compute_fre(fixed, moving, rotation, translation):
    """
    Computes the Fiducial Registration Error, equal
    to the root mean squared error between corresponding fiducials.

    :param fixed: point set, N x 3 ndarray
    :param moving: point set, N x 3 ndarray of corresponding points
    :param rotation: 3 x 3 ndarray
    :param translation: 3 x 1 ndarray
    :returns: Fiducial Registration Error (FRE)
    """
    # pylint: disable=assignment-from-no-return

    transformed_moving = np.matmul(rotation, moving) + translation
    squared_error_elementwise = np.square(fixed
                                          - transformed_moving)
    square_distance_error = np.sum(squared_error_elementwise, 1)
    sum_squared_error = np.sum(square_distance_error, 0)
    mean_squared_error = sum_squared_error / fixed.shape[0]
    fre = np.sqrt(mean_squared_error)
    return fre

'''

def KF_based_registration(source,target,R_0):
    #x_0 = np.array([R_0[0][0], R_0[0][1], R_0[0][2], R_0[1][0], R_0[1][1], R_0[1][2], R_0[2][0], R_0[2][1], R_0[2][2]]).T
    x_0 = np.array([1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0]).T
    Q = 0.1 * np.identity(9)
    I = np.identity(9)
    P_0 = Q
    H_k = np.zeros((3,9))
    R_init = np.array([0.1,0.1,0.1]) @ np.identity(3) 

    for k in range(np.size(source,1)):

        z_k = np.array([source[0,k],source[1,k],source[2,k]])
        print("z_k", z_k)
        H_k[0,:3] = z_k
        H_k[1,3:6] = z_k
        H_k[2,6:9] = z_k

        x_k = x_0
        y_k =  H_k @ x_k
        print("y_k", y_k)
        P_k = P_0 + Q

        K_k = P_k @ H_k.T @ np.linalg.inv((H_k @ P_k @ H_k.T + R_init))
        print("K_k",K_k)
        x_1 = x_k + K_k @ (z_k - y_k).T
        print("x_1", x_1)
        P_1 = (I - K_k @ H_k) @ P_k
        x_0 = x_1
        P_0 = P_1

    return x_k.reshape(3,3)
'''      
    





Obj_points = [[0,0,0], [0,-0.045,-0.05],[0,-0.09,-0.025], [0,-0.14,-0.025]]
Measured_points = [[0.007855520583689213, 0.015549231320619583, 0.15643294155597687], [-0.012558327987790108, -0.02908085100352764, 0.15417960286140442], [-0.025981204584240913, -0.11471205949783325, 0.15352417528629303], [-0.05560622736811638, -0.06465459614992142, 0.14636969566345215]]
permuted_list = list(itertools.permutations(Measured_points))

X = np.transpose(np.array(Measured_points))
Y = np.transpose(np.array(Obj_points))
min_err = 1000



for iter in range(len(permuted_list)):

    P = np.transpose(np.array(permuted_list[iter]))
    #print(P)
    Rot, Transl, T = Kabsch_Algorithm (P,Y)
    
    error = np.linalg.norm(Rot @ P + Transl - Y, 'fro')
    #print(error)
    
    if error < min_err:
        min_err = error
        match = P
        match_R = Rot
        match_t = Transl
        match_T = T

#result = KF_based_registration(match,Y,match_R)

##print(match)
#print(result)
#print(match_R)
#print(min_err)

#C = result @ match + match_t
#print(np.linalg.norm(C-Y))


def KF_filter(points):

    Q = np.diag([0.00001] * 9)
    R = np.diag([0.00015, 0.00015, 0.00021])
    P_k_posterior = Q
    I = np.identity(9)
    d_t = 0.022
    A = np.identity(9)
    A[0,1:3] = [d_t, 1/2 * d_t**2]
    A[1, 2] = d_t
    A[3,3:5] = [d_t, 1/2 * d_t**2]
    A[4,5] = d_t
    A[6,7:9] = [d_t, 1/2 * d_t**2]
    A[7,8] = d_t
    H = np.zeros((3,9))
    H[0,0] = 1
    H[1,3] = 1
    H[2,6] = 1
    z_k = np.array(points[0])

    x_k_posterior = np.array([z_k[0], 0.08, 0.1, z_k[1], 0.18, 0.1, z_k[2], 0.18, 0.1]).T

    #for steps in range(len(points)):

    x_k_prior = A @ x_k_posterior
    P_k_prior = A @  P_k_posterior @ A.T + Q
    K_k = P_k_prior @ H.T @ np.linalg.inv((H @ P_k_prior @ H.T + R))
    x_k_posterior =  x_k_prior + K_k @ (z_k - H @ x_k_prior)
    P_k_posterior = (I - K_k @ H) @ P_k_prior
    z_k = H @ x_k_posterior
    
    return z_k


points = np.array([[-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0028000737074762583, -0.00350647559389472, 0.24935965240001678], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.0027551644016057253, -0.00345023674890399, 0.24536028504371643], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3604283928871155, 0.12891095876693726, 0.3657015860080719], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916891386732459, -0.0012876491528004408, 0.24139583110809326], [-0.0005916891386732459, -0.0012876491528004408, 0.24139583110809326], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.0006014424725435674, -0.003450443735346198, 0.24537500739097595], [-0.3604283928871155, 0.12891095876693726, 0.3657015860080719], [-0.3631517291069031, 0.1298849880695343, 0.36846479773521423], [-0.3631517291069031, 0.1298849880695343, 0.36846479773521423], [-0.3631517291069031, 0.1298849880695343, 0.36846479773521423], [-0.3631517291069031, 0.1298849880695343, 0.36846479773521423], [-0.3631517291069031, 0.1298849880695343, 0.36846479773521423], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3658750355243683, 0.13085900247097015, 0.3712279200553894], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.3685983121395111, 0.131833016872406, 0.3739910423755646], [-0.0005916891386732459, -0.0012876491528004408, 0.24139583110809326], [-0.0005916891386732459, -0.0012876491528004408, 0.24139583110809326], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [-0.36717453598976135, 0.1370159089565277, 0.37930288910865784], [-0.36717453598976135, 0.1370159089565277, 0.37930288910865784], [-0.36717453598976135, 0.1370159089565277, 0.37930288910865784], [-0.3725602924823761, 0.13902567327022552, 0.38486650586128235], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [0.0015524185728281736, -0.0034503850620239973, 0.24537083506584167], [0.0015271141892299056, -0.003394144121557474, 0.24137131869792938], [0.0015272434102371335, -0.0012876272667199373, 0.24139174818992615], [-0.0005720805493183434, -0.0012449764180928469, 0.23339597880840302], [-0.0005818847566843033, -0.001266312669031322, 0.23739588260650635], [-0.0005916390218771994, -0.0033942016307264566, 0.2413754016160965], [-0.0026653464883565903, -0.0033377595245838165, 0.23736156523227692], [-0.0026649178471416235, -0.005408519878983498, 0.23732340335845947], [-0.002709819935262203, -0.005499649327248335, 0.2413221299648285], [-0.002709178486838937, -0.007604046259075403, 0.24126501381397247], [-0.0027521387673914433, -0.012002803385257721, 0.24509082734584808], [-0.0027508616913110018, -0.01413533091545105, 0.24497710168361664], [-0.0027493780944496393, -0.016264647245407104, 0.2448449730873108], [-0.0027045635506510735, -0.015999536961317062, 0.24085402488708496], [-0.002792476210743189, -0.018690045922994614, 0.24868305027484894], [-0.004897944163531065, -0.01626242883503437, 0.24481157958507538], [-0.006930545438081026, -0.01599394530057907, 0.24076984822750092], [-0.006930545438081026, -0.01599394530057907, 0.24076984822750092], [-0.00727506261318922, -0.01678900420665741, 0.25273850560188293], [-0.0073899030685424805, -0.01705402508378029, 0.25672808289527893], [-0.007504741661250591, -0.01731904409825802, 0.2607176601886749], [-0.007393887732177973, -0.014821358025074005, 0.25686654448509216], [-0.007508788723498583, -0.01505168154835701, 0.2608582377433777], [-0.006707591470330954, -0.011411871761083603, 0.23302432894706726], [-0.006707591470330954, -0.011411871761083603, 0.23302432894706726], [-0.004663113038986921, -0.011414309963583946, 0.2330740988254547], [-0.004663113038986921, -0.011414309963583946, 0.2330740988254547], [-0.0026175600942224264, -0.011415869928896427, 0.23310595750808716], [-0.0005618294235318899, -0.009224739857017994, 0.22921375930309296], [-0.0005716259474866092, -0.009385590441524982, 0.2332105189561844], [-0.0005716259474866092, -0.009385590441524982, 0.2332105189561844], [-0.0005718047614209354, -0.0073524885810911655, 0.23328346014022827], [-0.0005718047614209354, -0.0073524885810911655, 0.23328346014022827], [-0.0005718047614209354, -0.0073524885810911655, 0.23328346014022827], [-0.0005620051524601877, -0.007226481568068266, 0.22928543388843536], [-0.0005422363756224513, -0.008903040550649166, 0.2212202548980713], [-0.0005422363756224513, -0.008903040550649166, 0.2212202548980713], [-0.0005518184625543654, -0.01102523971349001, 0.22512950003147125], [-0.002438121009618044, -0.010633289813995361, 0.21712610125541687], [-0.0024818291421979666, -0.012752901762723923, 0.2210184633731842], [-0.002526667434722185, -0.012983306311070919, 0.22501155734062195], [-0.00433909147977829, -0.014406895264983177, 0.2168787121772766], [-0.00433909147977829, -0.014406895264983177, 0.2168787121772766], [-0.00624151062220335, -0.014403825625777245, 0.2168325036764145], [-0.008137498050928116, -0.01628156751394272, 0.21663667261600494], [-0.009844032116234303, -0.017819173634052277, 0.2124267816543579], [-0.009836527518928051, -0.019658183678984642, 0.21226483583450317], [-0.011903873644769192, -0.02188602276146412, 0.21596772968769073], [-0.013792518526315689, -0.021874748170375824, 0.21585647761821747], [-0.013526448048651218, -0.02330036275088787, 0.2116924226284027], [-0.015648454427719116, -0.025579139590263367, 0.21532206237316132], [-0.017508486285805702, -0.027411365881562233, 0.21495309472084045], [-0.017810596153140068, -0.029792778193950653, 0.21866214275360107], [-0.018980447202920914, -0.030496856197714806, 0.21035504341125488], [-0.021563032642006874, -0.033475544303655624, 0.21778976917266846], [-0.021534303203225136, -0.03532921522855759, 0.21749959886074066], [-0.021145246922969818, -0.03469093143939972, 0.21357007324695587], [-0.02299981378018856, -0.03466058149933815, 0.2133832424879074], [-0.025271179154515266, -0.03710779547691345, 0.2168002426624298], [-0.02665616199374199, -0.03640033304691315, 0.21266692876815796], [-0.02901613898575306, -0.03702974319458008, 0.2163442075252533], [-0.03092227876186371, -0.03514959663152695, 0.21639378368854523], [-0.03371562063694, -0.038324810564517975, 0.2359415739774704], [-0.03104538284242153, -0.03146081417798996, 0.20468206703662872], [-0.033467307686805725, -0.030239328742027283, 0.20857872068881989], [-0.03529078885912895, -0.028412943705916405, 0.20853495597839355], [-0.03536604344844818, -0.024825692176818848, 0.20897963643074036], [-0.03509090840816498, -0.021697400137782097, 0.19712892174720764], [-0.036827217787504196, -0.018259357661008835, 0.19716061651706696], [-0.03854998201131821, -0.014814787544310093, 0.19712023437023163], [-0.03857281431555748, -0.013102129101753235, 0.19723699986934662], [-0.040275268256664276, -0.009652340784668922, 0.19709564745426178], [-0.04110283777117729, -0.006339584477245808, 0.20114552974700928], [-0.041112180799245834, -0.0045850807800889015, 0.2011912614107132], [-0.03952023759484291, -0.0010316346306353807, 0.19340075552463531], [-0.03941962495446205, 0.0024432544596493244, 0.20156706869602203], [-0.03863842785358429, 0.005843557883054018, 0.1975724846124649], [-0.03694004938006401, 0.009301320649683475, 0.19776469469070435], [-0.034525804221630096, 0.012507678009569645, 0.19395436346530914], [-0.03283108025789261, 0.01589701883494854, 0.1940004527568817], [-0.030493393540382385, 0.01889016479253769, 0.19004438817501068], [-0.02940668724477291, 0.02265547402203083, 0.193878173828125], [-0.027711113914847374, 0.024353109300136566, 0.19392210245132446], [-0.027033507823944092, 0.028830863535404205, 0.20156171917915344], [-0.025260616093873978, 0.030585693195462227, 0.20153306424617767], [-0.023484768345952034, 0.032335247844457626, 0.20147469639778137], [-0.021706752479076385, 0.03407878428697586, 0.2013867199420929], [-0.01995640993118286, 0.03410855680704117, 0.20156265795230865], [-0.01817513071000576, 0.03584412857890129, 0.20142994821071625], [-0.014659023843705654, 0.035893525928258896, 0.20170754194259644], [-0.014088079333305359, 0.034495532512664795, 0.19385136663913727], [-0.0129148093983531, 0.03420288860797882, 0.2021200805902481], [-0.011379193514585495, 0.03313353285193443, 0.20644864439964294], [-0.011394294910132885, 0.0313732847571373, 0.20672261714935303], [-0.009779210202395916, 0.03018488921225071, 0.21102797985076904], [-0.009790804237127304, 0.02837669663131237, 0.21127815544605255], [-0.009995825588703156, 0.02520572394132614, 0.2157023698091507], [-0.010189594700932503, 0.023775247856974602, 0.2198837548494339], [-0.010014449246227741, 0.021480482071638107, 0.21610426902770996], [-0.010030148550868034, 0.01773603819310665, 0.2164430320262909], [-0.010036886669695377, 0.015857625752687454, 0.21658843755722046], [-0.010417875833809376, 0.012535398826003075, 0.2248098999261856], [-0.012831080704927444, 0.010948625393211842, 0.23278971016407013], [-0.012839623726904392, 0.006889753974974155, 0.23294471204280853], [-0.0146270040422678, 0.0027747636195272207, 0.22891637682914734], [-0.014627866446971893, -0.0012211535358801484, 0.22892989218235016], [-0.016623416915535927, -0.00521284993737936, 0.2287375032901764], [-0.017483433708548546, -0.009681827388703823, 0.24057132005691528], [-0.01956542395055294, -0.013860050588846207, 0.2402062714099884], [-0.020557625219225883, -0.0171231497079134, 0.22783446311950684], [-0.023683983832597733, -0.02215377427637577, 0.23921169340610504], [-0.023272208869457245, -0.023820078000426292, 0.235052689909935], [-0.025691218674182892, -0.028315100818872452, 0.23835304379463196], [-0.02726840041577816, -0.029831895604729652, 0.23393428325653076], [-0.027696913108229637, -0.032374490052461624, 0.23761047422885895], [-0.030171312391757965, -0.036998722702264786, 0.24071136116981506], [-0.031156398355960846, -0.037733618170022964, 0.2323019951581955], [-0.031156398355960846, -0.037733618170022964, 0.2323019951581955], [-0.03366883099079132, -0.0403280109167099, 0.23561415076255798], [-0.03417687863111496, -0.04302395135164261, 0.23916947841644287], [-0.036766428500413895, -0.04572086036205292, 0.2424008995294571], [-0.03670807182788849, -0.04776054248213768, 0.24201615154743195], [-0.03816046193242073, -0.04693403095006943, 0.23782797157764435], [-0.038718510419130325, -0.04972643032670021, 0.241305872797966], [-0.038718510419130325, -0.04972643032670021, 0.241305872797966], [-0.040711719542741776, -0.05167388916015625, 0.24056752026081085], [-0.04063946008682251, -0.05367805436253548, 0.24014052748680115], [-0.03796233609318733, -0.05209982767701149, 0.22432127594947815], [-0.04184594005346298, -0.05664945766329765, 0.2350764125585556], [-0.043125446885824203, -0.060496024787425995, 0.2422642558813095], [-0.040906310081481934, -0.05468636006116867, 0.21899870038032532], [-0.04714234918355942, -0.062298234552145004, 0.2410561889410019], [-0.04788651317358017, -0.06328163295984268, 0.24486134946346283], [-0.05062828212976456, -0.06619323790073395, 0.2477603405714035], [-0.04985355585813522, -0.06518033146858215, 0.24396906793117523], [-0.050994958728551865, -0.06601490080356598, 0.2392762154340744], [-0.05088410526514053, -0.06795519590377808, 0.23875606060028076], [-0.0516873262822628, -0.06902790069580078, 0.2425249218940735], [-0.05360571667551994, -0.07086633890867233, 0.2415764033794403], [-0.053900063037872314, -0.06854399293661118, 0.2336597442626953], [-0.053900063037872314, -0.06854399293661118, 0.2336597442626953], [-0.053900063037872314, -0.06854399293661118, 0.2336597442626953], [-0.05572356656193733, -0.07029625028371811, 0.23270945250988007], [-0.056617286056280136, -0.07142368704080582, 0.2364417463541031], [-0.05858368054032326, -0.07129096239805222, 0.2360023558139801], [-0.058448247611522675, -0.0731811597943306, 0.23545674979686737], [-0.06039953976869583, -0.07304143905639648, 0.23500721156597137], [-0.061352964490652084, -0.07419442385435104, 0.23871690034866333], [-0.0621931217610836, -0.07476876676082611, 0.2339940071105957], [-0.06411757320165634, -0.07461802661418915, 0.23352225124835968], [-0.06411757320165634, -0.07461802661418915, 0.23352225124835968], [-0.06603024154901505, -0.07446333020925522, 0.23303812742233276], [-0.06685858219861984, -0.07313185185194016, 0.2288712114095688], [-0.0685548409819603, -0.07478819042444229, 0.22783179581165314], [-0.06871715188026428, -0.07297208905220032, 0.22837118804454803], [-0.0685548409819603, -0.07478819042444229, 0.22783179581165314], [-0.07039748132228851, -0.07462149113416672, 0.227323979139328], [-0.07222767919301987, -0.07445116341114044, 0.22680509090423584], [-0.07222767919301987, -0.07445116341114044, 0.22680509090423584], [-0.07285763323307037, -0.07308598607778549, 0.22264625132083893], [-0.0746333971619606, -0.07291149348020554, 0.2221146821975708], [-0.07782113552093506, -0.07212027162313461, 0.2257053554058075], [-0.07657299935817719, -0.07096356153488159, 0.2220853716135025], [-0.07850223779678345, -0.06900748610496521, 0.2220282107591629], [-0.08024505525827408, -0.06883067637681961, 0.2214593142271042], [-0.08024505525827408, -0.06883067637681961, 0.2214593142271042], [-0.07679625600576401, -0.06250839680433273, 0.20692847669124603], [-0.08656616508960724, -0.05879112705588341, 0.2130930870771408], [-0.0867319256067276, -0.057040322571992874, 0.21350112557411194], [-0.0867319256067276, -0.057040322571992874, 0.21350112557411194], [-0.08851224184036255, -0.055118538439273834, 0.21327511966228485], [-0.08875665068626404, -0.05229802802205086, 0.20943431556224823], [-0.08891008049249649, -0.05055738985538483, 0.20979635417461395], [-0.08752139657735825, -0.046991944313049316, 0.20232874155044556], [-0.0876619964838028, -0.04529872536659241, 0.20265378057956696], [-0.08454786241054535, -0.04114863649010658, 0.19156725704669952], [-0.08784753084182739, -0.04101734608411789, 0.19904358685016632], [-0.0894392728805542, -0.039211999624967575, 0.1986982524394989], [-0.08805719763040543, -0.03519129753112793, 0.1956278532743454], [-0.08816663920879364, -0.03352551907300949, 0.19587098062038422], [-0.08502276241779327, -0.03068150021135807, 0.18888655304908752], [-0.08824283629655838, -0.02787787653505802, 0.19229036569595337], [-0.08998657763004303, -0.02671734057366848, 0.19609017670154572], [-0.0850992500782013, -0.02364780381321907, 0.18544018268585205], [-0.08690349012613297, -0.020843597128987312, 0.18937179446220398], [-0.08665144443511963, -0.018776003271341324, 0.18527856469154358], [-0.08676564693450928, -0.015562360174953938, 0.18552275002002716], [-0.08681481331586838, -0.013951067812740803, 0.18562787771224976], [-0.08858940005302429, -0.01092978473752737, 0.18942230939865112], [-0.08695799857378006, -0.007482942193746567, 0.18593402206897736], [-0.0852864682674408, -0.005747511517256498, 0.1823599487543106], [-0.0853142961859703, -0.002565167611464858, 0.18241944909095764], [-0.08532080054283142, 0.0006190983694978058, 0.1824333816766739], [-0.08700025826692581, 0.00387842976488173, 0.18602439761161804], [-0.08526989817619324, 0.006983852945268154, 0.18232451379299164], [-0.08182776719331741, 0.009756023064255714, 0.1749645322561264], [-0.08048591017723083, 0.01284105982631445, 0.17538724839687347], [-0.07872870564460754, 0.015555336140096188, 0.17155809700489044], [-0.07893615961074829, 0.020492076873779297, 0.17536452412605286], [-0.07708819955587387, 0.02449645847082138, 0.17125913500785828], [-0.0772610679268837, 0.028095390647649765, 0.17505694925785065], [-0.0785670056939125, 0.03323131799697876, 0.17801593244075775], [-0.08311288058757782, 0.03844122216105461, 0.18831589818000793], [-0.07524290680885315, 0.038543689996004105, 0.17394378781318665], [-0.0737004354596138, 0.04157116264104843, 0.17390698194503784], [-0.07796098291873932, 0.04982299730181694, 0.18785129487514496], [-0.07332713156938553, 0.05102497339248657, 0.18050357699394226], [-0.0702298954129219, 0.05303339287638664, 0.17669746279716492], [-0.06718277186155319, 0.05489527806639671, 0.17284831404685974], [-0.06689965724945068, 0.05900084227323532, 0.1760968565940857], [-0.06404659897089005, 0.05932683125138283, 0.17257437109947205], [-0.06238618493080139, 0.06219406798481941, 0.17217262089252472], [-0.06087252125144005, 0.0636942982673645, 0.17216600477695465], [-0.05935175344347954, 0.06518647819757462, 0.17213845252990723], [-0.06021639332175255, 0.06942792236804962, 0.17920856177806854], [-0.05978396162390709, 0.07237285375595093, 0.18269430100917816], [-0.055885013192892075, 0.0710492879152298, 0.17548683285713196], [-0.05667061731219292, 0.07409027963876724, 0.1829978972673416], [-0.05502532795071602, 0.07563391327857971, 0.18286848068237305], [-0.05353067070245743, 0.07579043507575989, 0.1832469254732132], [-0.05288606509566307, 0.07882650196552277, 0.1866488754749298], [-0.05134767293930054, 0.07898030430078506, 0.18701305985450745], [-0.04824438318610191, 0.07927589863538742, 0.18771299719810486], [-0.04387327656149864, 0.07618512213230133, 0.17674197256565094], [-0.04325370863080025, 0.07786261290311813, 0.1806335747241974], [-0.04243643581867218, 0.08090391755104065, 0.18396428227424622], [-0.04234739765524864, 0.08559345453977585, 0.19084030389785767], [-0.039970919489860535, 0.08411762118339539, 0.18754974007606506], [-0.037528760731220245, 0.08397369086742401, 0.1836550235748291], [-0.035852979868650436, 0.0860888734459877, 0.19194486737251282], [-0.0328248031437397, 0.08431372791528702, 0.18439871072769165], [-0.030236205086112022, 0.08616223186254501, 0.18844148516654968], [-0.028067249804735184, 0.08461027592420578, 0.18504726886749268], [-0.028107700869441032, 0.08822041749954224, 0.196697399020195], [-0.026407402008771896, 0.08830835670232773, 0.19689348340034485], [-0.025611167773604393, 0.09164362400770187, 0.20432983338832855], [-0.022641627117991447, 0.08542359620332718, 0.19424141943454742], [-0.021414082497358322, 0.0856378823518753, 0.19867146015167236], [-0.01974668726325035, 0.08423037081956863, 0.19944439828395844], [-0.01974668726325035, 0.08423037081956863, 0.19944439828395844], [-0.018064189702272415, 0.08280235528945923, 0.2002004235982895], [-0.018452534452080727, 0.0827975794672966, 0.2045043408870697], [-0.016718123108148575, 0.0813080221414566, 0.20524977147579193], [-0.017119957134127617, 0.0795934796333313, 0.21018312871456146], [-0.017473483458161354, 0.07936476916074753, 0.21452336013317108], [-0.01757063902914524, 0.07604062557220459, 0.215716153383255], [-0.01735660433769226, 0.07139478623867035, 0.21308845281600952], [-0.017755240201950073, 0.06922954320907593, 0.21798253059387207], [-0.01779923029243946, 0.06749385595321655, 0.2185225933790207], [-0.017884455621242523, 0.06398434191942215, 0.2195689082145691], [-0.017965855076909065, 0.060425449162721634, 0.22056826949119568], [-0.018043246120214462, 0.05681902542710304, 0.2215183824300766], [-0.01780056208372116, 0.05224010348320007, 0.21853895485401154], [-0.020093290135264397, 0.0512884259223938, 0.22268837690353394], [-0.020166929811239243, 0.04757501929998398, 0.22350451350212097], [-0.020235493779182434, 0.043822117149829865, 0.22426436841487885], [-0.021834373474121094, 0.041167743504047394, 0.22053034603595734], [-0.022676857188344002, 0.03875821456313133, 0.22903956472873688], [-0.022319167852401733, 0.036179400980472565, 0.22542685270309448], [-0.024763310328125954, 0.03286202251911163, 0.22974428534507751], [-0.024792399257421494, 0.030893120914697647, 0.2300141602754593], [-0.02527114935219288, 0.027397140860557556, 0.23445580899715424], [-0.0257215928286314, 0.0258027333766222, 0.23863482475280762], [-0.02491145022213459, 0.020955752581357956, 0.23111867904663086], [-0.024929871782660484, 0.018952611833810806, 0.2312895804643631], [-0.024946464225649834, 0.01694524474442005, 0.23144350945949554], [-0.024961216375231743, 0.014934095554053783, 0.23158037662506104], [-0.02584156021475792, 0.0112758819013834, 0.23974783718585968], [-0.025851057842373848, 0.009186801500618458, 0.2398359477519989], [-0.025858620181679726, 0.007095649838447571, 0.23990611732006073], [-0.025435667484998703, 0.004920000676065683, 0.23598213493824005], [-0.02586965262889862, 0.0008144829189404845, 0.24000847339630127], [-0.026726748794317245, -0.0013226651353761554, 0.24796028435230255], [-0.02672451175749302, -0.0034865059424191713, 0.24793954193592072], [-0.026720264926552773, -0.005649560131132603, 0.247900128364563], [-0.02416657842695713, -0.007692955434322357, 0.24408596754074097], [-0.026705754920840263, -0.009971357882022858, 0.24776549637317657], [-0.026695499196648598, -0.012129129841923714, 0.24767035245895386], [-0.025827333331108093, -0.013825982809066772, 0.23961584270000458], [-0.024519057944417, -0.01645071990787983, 0.2476460337638855], [-0.026225347071886063, -0.018286118283867836, 0.24330848455429077], [-0.025760821998119354, -0.02213405631482601, 0.23899880051612854], [-0.025739479809999466, -0.02419990673661232, 0.2388007640838623], [-0.02442648448050022, -0.02715475670993328, 0.24671104550361633], [-0.026542628183960915, -0.029253464192152023, 0.24625207483768463], [-0.027334779500961304, -0.034553252160549164, 0.2536013424396515], [-0.02687799371778965, -0.03615221753716469, 0.2493634670972824], [-0.02684413455426693, -0.038280319422483444, 0.2490493357181549], [-0.02680843137204647, -0.040400147438049316, 0.24871809780597687], [-0.02677091211080551, -0.042511314153671265, 0.2483700066804886], [-0.02715357020497322, -0.04531765729188919, 0.2519201636314392], [-0.0271118376404047, -0.04744332656264305, 0.25153297185897827], [-0.026647692546248436, -0.04878884553909302, 0.24722683429718018], [-0.029650259763002396, -0.05241820216178894, 0.2543681561946869], [-0.02959883026778698, -0.05454348772764206, 0.25392693281173706], [-0.02954554744064808, -0.056657519191503525, 0.2534698247909546], [-0.02949044667184353, -0.05875994637608528, 0.25299713015556335], [-0.029433565214276314, -0.06085044518113136, 0.25250911712646484], [-0.032038770616054535, -0.06382864713668823, 0.2556101977825165], [-0.03197307139635086, -0.06592409312725067, 0.2550860345363617], [-0.032386403530836105, -0.06903142482042313, 0.25838369131088257], [-0.034543175250291824, -0.07105756551027298, 0.2575537860393524], [-0.034977953881025314, -0.07422810047864914, 0.2607954740524292], [-0.0317598357796669, -0.07153227180242538, 0.23680120706558228], [-0.03473246842622757, -0.0804876834154129, 0.2589651644229889], [-0.03633515536785126, -0.08124858140945435, 0.25427305698394775], [-0.036243997514247894, -0.08325840532779694, 0.25363513827323914], [-0.03659184277057648, -0.08852727711200714, 0.2560693621635437], [-0.03869229555130005, -0.09041793644428253, 0.2550981044769287], [-0.038587238639593124, -0.09239283204078674, 0.25440549850463867], [-0.040659546852111816, -0.09424040466547012, 0.25340306758880615], [-0.040545325726270676, -0.09618107974529266, 0.2526911795139313], [-0.04042944684624672, -0.09810531884431839, 0.25196897983551025], [-0.0424654446542263, -0.09989096969366074, 0.2509303390979767], [-0.04447978362441063, -0.1016506776213646, 0.24987246096134186], [-0.044995877891778946, -0.10503623634576797, 0.2527717053890228], [-0.04783196002244949, -0.10640943795442581, 0.2560763359069824], [-0.04700959846377373, -0.10677651315927505, 0.25167369842529297], [-0.04686551168560982, -0.10863905400037766, 0.25090229511260986], [-0.049000684171915054, -0.10849020630121231, 0.2505585551261902], [-0.049553174525499344, -0.1119249165058136, 0.2533836364746094], [-0.0531737394630909, -0.11494340747594833, 0.2602171003818512], [-0.047878604382276535, -0.10554207861423492, 0.23430421948432922], [-0.052150968462228775, -0.11022502928972244, 0.24470040202140808], [-0.05421607196331024, -0.11005682498216629, 0.24432699382305145], [-0.05421607196331024, -0.11005682498216629, 0.24432699382305145], [-0.05609457567334175, -0.11165940016508102, 0.24317306280136108], [-0.05813431739807129, -0.1114775761961937, 0.24277707934379578], [-0.06085101142525673, -0.1147003099322319, 0.24513621628284454], [-0.06085101142525673, -0.1147003099322319, 0.24513621628284454], [-0.06289398670196533, -0.1145021989941597, 0.24471281468868256], [-0.063990019261837, -0.11265014111995697, 0.24075458943843842], [-0.06598211824893951, -0.11244354397058487, 0.2403130829334259], [-0.06696876138448715, -0.1105894073843956, 0.2363504320383072], [-0.06890960782766342, -0.11037503927946091, 0.23589229583740234], [-0.07294264435768127, -0.1134265884757042, 0.24241402745246887], [-0.07383710145950317, -0.11156293004751205, 0.23843103647232056], [-0.07655660808086395, -0.10946621745824814, 0.2339499592781067], [-0.07727357000112534, -0.10760492086410522, 0.22997203469276428], [-0.08055128902196884, -0.10727453231811523, 0.2336236536502838], [-0.07874137163162231, -0.10226072371006012, 0.22270452976226807], [-0.08325587213039398, -0.10349898040294647, 0.2297685295343399], [-0.0850677639245987, -0.1032501608133316, 0.22921614348888397], [-0.08756795525550842, -0.09951777011156082, 0.22529543936252594], [-0.09094059467315674, -0.0990711897611618, 0.2288052886724472], [-0.08876046538352966, -0.09269975870847702, 0.21849459409713745], [-0.09354537725448608, -0.09366339445114136, 0.22540274262428284], [-0.09380578249692917, -0.09197869896888733, 0.22134849429130554], [-0.09896957129240036, -0.0910789743065834, 0.22879423201084137], [-0.09790508449077606, -0.0863712802529335, 0.22183184325695038], [-0.09670921415090561, -0.08177738636732101, 0.21484915912151337], [-0.10173295438289642, -0.0808977261185646, 0.217525914311409], [-0.10197427868843079, -0.07918661832809448, 0.21804191172122955], [-0.10381047427654266, -0.07722574472427368, 0.21787869930267334], [-0.10563202202320099, -0.07525933533906937, 0.21769119799137115], [-0.10743839293718338, -0.07328810542821884, 0.2174796611070633], [-0.10766887664794922, -0.0715431421995163, 0.21794621646404266], [-0.1060011088848114, -0.06736525893211365, 0.21082422137260437], [-0.1064281091094017, -0.06394175440073013, 0.21167348325252533], [-0.10813713818788528, -0.062008872628211975, 0.21138215065002441], [-0.10499965399503708, -0.056627027690410614, 0.2052491456270218], [-0.10714296251535416, -0.054127078503370285, 0.20943878591060638], [-0.10355067253112793, -0.04795614629983902, 0.19900207221508026], [-0.10892435163259506, -0.04601462185382843, 0.20585648715496063], [-0.10878926515579224, -0.041677288711071014, 0.2022460550069809], [-0.10720247775316238, -0.03759058192372322, 0.19929611682891846], [-0.1088188961148262, -0.034070130437612534, 0.1990528255701065], [-0.10654985159635544, -0.029484184458851814, 0.19182223081588745], [-0.10422638058662415, -0.02355598472058773, 0.18472015857696533], [-0.11155631393194199, -0.021428104490041733, 0.1946822702884674], [-0.10897723585367203, -0.017347263172268867, 0.1873120218515396], [-0.11240150034427643, -0.012643049471080303, 0.19032609462738037], [-0.11782751977443695, -0.009627667255699635, 0.1965918242931366], [-0.11499634385108948, -0.00595989590510726, 0.18909859657287598], [-0.11710795760154724, -0.002707916544750333, 0.19257089495658875], [-0.1183370053768158, 0.002325145062059164, 0.1918230950832367], [-0.11739730089902878, 0.005549492314457893, 0.1876300424337387], [-0.12062051147222519, 0.010600777342915535, 0.19011437892913818], [-0.1183851808309555, 0.01366136223077774, 0.18659117817878723], [-0.11935793608427048, 0.018444137647747993, 0.18555715680122375], [-0.11704643070697784, 0.021263210102915764, 0.18196362257003784], [-0.11799436807632446, 0.024305712431669235, 0.18096773326396942], [-0.11779075115919113, 0.027417195960879326, 0.18065544962882996], [-0.11756354570388794, 0.030511658638715744, 0.18030700087547302], [-0.11947162449359894, 0.034205302596092224, 0.18323341012001038], [-0.11689511686563492, 0.03816180303692818, 0.1792818158864975], [-0.11459667235612869, 0.038945406675338745, 0.17575669288635254], [-0.12285416573286057, 0.04504068195819855, 0.18842118978500366], [-0.11708099395036697, 0.04668709263205528, 0.18201735615730286], [-0.11671634763479233, 0.04970898851752281, 0.18145045638084412], [-0.1110139712691307, 0.05098874121904373, 0.17497316002845764], [-0.11360450834035873, 0.056079965084791183, 0.1815682202577591], [-0.1090935617685318, 0.05689669027924538, 0.17435860633850098], [-0.11156599968671799, 0.06217087805271149, 0.18084736168384552], [-0.11111077666282654, 0.06506109237670898, 0.180109441280365], [-0.11463672667741776, 0.07036939263343811, 0.18582497537136078], [-0.11612150073051453, 0.07456647604703903, 0.18823176622390747], [-0.11042431741952896, 0.07510116696357727, 0.18158039450645447], [-0.11185009777545929, 0.07928135246038437, 0.18392492830753326], [-0.11006755381822586, 0.08236610144376755, 0.18364454805850983], [-0.10922478884458542, 0.08650702238082886, 0.1822383999824524], [-0.10893772542476654, 0.08786600828170776, 0.18175944685935974], [-0.10309668630361557, 0.08896158635616302, 0.17457054555416107], [-0.10838273912668228, 0.09512462466955185, 0.18352125585079193], [-0.10833042114973068, 0.0997634306550026, 0.18620024621486664], [-0.10640595853328705, 0.10273366421461105, 0.18569415807724], [-0.10301844030618668, 0.10260390490293503, 0.18257932364940643], [-0.09937124699354172, 0.10365818440914154, 0.17889855802059174], [-0.09778554737567902, 0.1052030697464943, 0.17887049913406372], [-0.09886633604764938, 0.10952261835336685, 0.18084749579429626], [-0.09757296741008759, 0.11328557878732681, 0.18440347909927368], [-0.09720403701066971, 0.11802181601524353, 0.18680521845817566], [-0.09550576657056808, 0.11957897245883942, 0.18669088184833527], [-0.0953553169965744, 0.1231301799416542, 0.18965095281600952], [-0.09503208845853806, 0.12436240911483765, 0.18900807201862335], [-0.09514220058917999, 0.12671881914138794, 0.1925893872976303], [-0.09191132336854935, 0.12860986590385437, 0.19290462136268616], [-0.09044250845909119, 0.12892988324165344, 0.19338461756706238], [-0.09044250845909119, 0.12892988324165344, 0.19338461756706238], [-0.08887512236833572, 0.13163688778877258, 0.19744493067264557], [-0.08581344038248062, 0.1322605460882187, 0.19838035106658936], [-0.08426640927791595, 0.13256627321243286, 0.19883893430233002], [-0.08140312135219574, 0.13077044486999512, 0.19614531099796295], [-0.0811404436826706, 0.13316501677036285, 0.19973699748516083], [-0.0779726579785347, 0.13374610245227814, 0.20060856640338898], [-0.07786275446414948, 0.1348547488451004, 0.20495450496673584], [-0.07503862679004669, 0.13303741812705994, 0.2021925002336502], [-0.0734144076704979, 0.133310928940773, 0.2026081681251526], [-0.0717802569270134, 0.1335795372724533, 0.20301641523838043], [-0.06956375390291214, 0.13621841371059418, 0.20702703297138214], [-0.06873685121536255, 0.13281378149986267, 0.2045661211013794], [-0.06642301380634308, 0.13541828095912933, 0.20857764780521393], [-0.0647093802690506, 0.13566409051418304, 0.2089562565088272], [-0.06518722325563431, 0.13876193761825562, 0.21664002537727356], [-0.062440138310194016, 0.13690823316574097, 0.21374593675136566], [-0.06066642329096794, 0.13714002072811127, 0.21410781145095825], [-0.05820068344473839, 0.13392220437526703, 0.21197237074375153], [-0.058184705674648285, 0.138307124376297, 0.21891285479068756], [-0.05571043863892555, 0.135056734085083, 0.216762512922287], [-0.05409178510308266, 0.13386793434619904, 0.2179069221019745], [-0.04964228719472885, 0.13220621645450592, 0.21520203351974487], [-0.04949096217751503, 0.1350705325603485, 0.22303307056427002], [-0.04817802086472511, 0.12959231436252594, 0.21711625158786774], [-0.0453442744910717, 0.1305120885372162, 0.22190192341804504], [-0.04551168158650398, 0.12905007600784302, 0.2227211743593216], [-0.04185926169157028, 0.12789340317249298, 0.2241005003452301], [-0.04201216250658035, 0.12639755010604858, 0.22491909563541412], [-0.038876667618751526, 0.12709283828735352, 0.22972410917282104], [-0.039156511425971985, 0.12396886199712753, 0.2313777208328247], [-0.03729839622974396, 0.1225174143910408, 0.2324552983045578], [-0.03742961958050728, 0.12091250717639923, 0.23327311873435974], [-0.03566594049334526, 0.11777837574481964, 0.23514537513256073], [-0.03324256092309952, 0.11448869109153748, 0.23263110220432281], [-0.03144187480211258, 0.11128216236829758, 0.2344304919242859], [-0.03154619783163071, 0.1095985546708107, 0.23520833253860474], [-0.029701683670282364, 0.10628058761358261, 0.23696459829807281], [-0.029796753078699112, 0.1045459732413292, 0.23772305250167847], [-0.027054788544774055, 0.09802237898111343, 0.23210172355175018], [-0.027994735166430473, 0.099331796169281, 0.24016547203063965], [-0.02558906003832817, 0.09611818194389343, 0.23740527033805847], [-0.02359367161989212, 0.09440042078495026, 0.23829953372478485], [-0.023731622844934464, 0.09076841920614243, 0.23969285190105438], [-0.023799143731594086, 0.08892873674631119, 0.24037481844425201], [-0.021765612065792084, 0.08713693171739578, 0.24122226238250732], [-0.022164562717080116, 0.08659019321203232, 0.2456437200307846], [-0.021884193643927574, 0.08337808400392532, 0.24253647029399872], [-0.019872047007083893, 0.07961251586675644, 0.24397072196006775], [-0.019922401756048203, 0.07767954468727112, 0.2445889413356781], [-0.019971761852502823, 0.07573199272155762, 0.2451949417591095], [-0.019397873431444168, 0.07147733867168427, 0.2381492704153061], [-0.017359061166644096, 0.06960592418909073, 0.23885990679264069], [-0.01715848222374916, 0.06468041241168976, 0.236099973320961], [-0.01719597540795803, 0.06275662034749985, 0.2366158664226532], [-0.01568605937063694, 0.06082534044981003, 0.2454908937215805], [-0.01522122137248516, 0.05694376677274704, 0.23821604251861572], [-0.015777312219142914, 0.054714053869247437, 0.24691900610923767], [-0.014558294788002968, 0.04849809408187866, 0.2278410792350769], [-0.015083471313118935, 0.04818734526634216, 0.2360602170228958], [-0.015609384514391422, 0.04773537442088127, 0.24429090321063995], [-0.015885166823863983, 0.04640898108482361, 0.24860697984695435], [-0.015932874754071236, 0.042195770889520645, 0.24935361742973328], [-0.016206977888941765, 0.04070795327425003, 0.2536433935165405], [-0.01572408340871334, 0.03734726831316948, 0.24608595669269562], [-0.014023762196302414, 0.036392733454704285, 0.25442811846733093], [-0.014040375128388405, 0.0342126339673996, 0.2547295093536377], [-0.01383756473660469, 0.03152734041213989, 0.2510499954223633], [-0.013865352608263493, 0.027199653908610344, 0.25155413150787354], [-0.013877743855118752, 0.02502649649977684, 0.2517789602279663], [-0.013669878244400024, 0.02248709835112095, 0.24800772964954376], [-0.013899478130042553, 0.02066388912498951, 0.2521732747554779], [-0.0139171052724123, 0.016282707452774048, 0.2524930536746979], [-0.01392436120659113, 0.014086351729929447, 0.2526246905326843], [-0.011532292701303959, 0.01170436106622219, 0.24885815382003784], [-0.011536570265889168, 0.009535928256809711, 0.24895046651363373], [-0.011542510241270065, 0.005193050019443035, 0.2490786612033844], [-0.013944904319941998, 0.003066657343879342, 0.25299742817878723], [-0.01173010841012001, 0.0008590008947066963, 0.253126859664917], [-0.011915171518921852, -0.0013715268578380346, 0.25712040066719055], [-0.011912254616618156, -0.005858252756297588, 0.2570574879646301], [-0.009804092347621918, -0.010504175908863544, 0.26100480556488037], [-0.009500355459749699, -0.012386158108711243, 0.2529187500476837], [-0.0073899030685424805, -0.01705402508378029, 0.25672808289527893], [-0.007380277384072542, -0.02150728739798069, 0.256393700838089], [-0.00528618274256587, -0.024469522759318352, 0.26421666145324707], [-0.007704958785325289, -0.02946200780570507, 0.2676732540130615], [-0.007468795869499445, -0.03082355111837387, 0.25946885347366333], [-0.007680547423660755, -0.03635500743985176, 0.26682519912719727], [-0.007329610642045736, -0.03691626340150833, 0.25463351607322693], [-0.007206521462649107, -0.038481369614601135, 0.25035735964775085], [-0.009671567007899284, -0.044070031493902206, 0.25747671723365784], [-0.009657224640250206, -0.046248532831668854, 0.2570948898792267], [-0.011891275644302368, -0.04839995130896568, 0.25660476088523865], [-0.011872023344039917, -0.05055753514170647, 0.2561893165111542], [-0.01471206359565258, -0.057333480566740036, 0.2669157087802887], [-0.01404075138270855, -0.05694061517715454, 0.2547363042831421], [-0.014228753745555878, -0.059956081211566925, 0.2581471800804138], [-0.01666894741356373, -0.0651429146528244, 0.26087334752082825], [-0.018908997997641563, -0.06724236905574799, 0.26018697023391724], [-0.018827276304364204, -0.07147381454706192, 0.2590625286102295], [-0.021665463224053383, -0.07570619136095047, 0.26598864793777466], [-0.02187512256205082, -0.08112668991088867, 0.2685626447200775], [-0.023127079010009766, -0.07966277003288269, 0.25631099939346313], [-0.025231029838323593, -0.08365295827388763, 0.2548370659351349], [-0.025539398193359375, -0.08692668378353119, 0.25795161724090576], [-0.028518741950392723, -0.09147151559591293, 0.2645857036113739], [-0.028846314176917076, -0.09485793113708496, 0.26762479543685913], [-0.030647560954093933, -0.09548649936914444, 0.2629239559173584], [-0.030908536165952682, -0.10092812776565552, 0.265162855386734], [-0.032645925879478455, -0.10140907764434814, 0.2604542076587677], [-0.03479607030749321, -0.1032782569527626, 0.2594393789768219], [-0.03479607030749321, -0.1032782569527626, 0.2594393789768219], [-0.0369253009557724, -0.1051209419965744, 0.25840291380882263], [-0.04069773852825165, -0.11149715632200241, 0.2683200240135193], [-0.041119396686553955, -0.1087261289358139, 0.2562689781188965], [-0.04318349435925484, -0.1104883998632431, 0.25517338514328003], [-0.04536658152937889, -0.11035020649433136, 0.2548542022705078], [-0.04604615643620491, -0.10889121890068054, 0.24651575088500977], [-0.050801824778318405, -0.11701241135597229, 0.25976842641830444], [-0.05210857838392258, -0.11709211766719818, 0.25500449538230896], [-0.05426767095923424, -0.11692121624946594, 0.25463229417800903], [-0.0562368743121624, -0.11858279258012772, 0.25343382358551025], [-0.05818193033337593, -0.12021704018115997, 0.25222188234329224], [-0.06010272353887558, -0.12182408571243286, 0.2509974241256714], [-0.06339175999164581, -0.11971382796764374, 0.2466496080160141], [-0.06522849202156067, -0.12125613540410995, 0.24541424214839935], [-0.06821760535240173, -0.12275850772857666, 0.24845494329929352], [-0.0700385645031929, -0.12428818643093109, 0.24718454480171204], [-0.07385066151618958, -0.12554886937141418, 0.24543166160583496], [-0.07585488259792328, -0.1253008097410202, 0.24494674801826477], [-0.0786786749958992, -0.12853923439979553, 0.24706214666366577], [-0.08152800053358078, -0.12623514235019684, 0.24263352155685425], [-0.08087173849344254, -0.12407822161912918, 0.23455305397510529], [-0.08274949342012405, -0.12380720674991608, 0.2340407371520996], [-0.08896128833293915, -0.12680481374263763, 0.23970729112625122], [-0.09372957050800323, -0.12967166304588318, 0.24114808440208435], [-0.0942959412932396, -0.1275741010904312, 0.2372472882270813], [-0.0979793518781662, -0.1269499957561493, 0.2360866367816925], [-0.09529787302017212, -0.12288074195384979, 0.2248692810535431], [-0.104123055934906, -0.13153578341007233, 0.24070784449577332], [-0.10631873458623886, -0.1290711611509323, 0.23619765043258667], [-0.10661093145608902, -0.1269502341747284, 0.23231638967990875], [-0.10835859179496765, -0.12660951912403107, 0.23169291019439697], [-0.11181147396564484, -0.12591727077960968, 0.23042608797550201], [-0.11386632174253464, -0.12394119054079056, 0.23049122095108032], [-0.11556027829647064, -0.12358903139829636, 0.22983631491661072], [-0.1123102530837059, -0.11805222928524017, 0.219539612531662], [-0.1222376823425293, -0.12631970643997192, 0.23491451144218445], [-0.12427046149969101, -0.122212715446949, 0.2310265600681305], [-0.12417659908533096, -0.1201595589518547, 0.22714532911777496], [-0.12438178807497025, -0.11650172621011734, 0.2239251583814621], [-0.12774646282196045, -0.11779177933931351, 0.22640472650527954], [-0.12605851888656616, -0.1125347688794136, 0.2199907898902893], [-0.1275835484266281, -0.1121777594089508, 0.21929287910461426], [-0.12909403443336487, -0.11181876063346863, 0.2185910940170288], [-0.13094812631607056, -0.10985668003559113, 0.21848313510417938], [-0.13232199847698212, -0.10597815364599228, 0.21449263393878937], [-0.12788577377796173, -0.10098815709352493, 0.20439322292804718], [-0.13587766885757446, -0.10207635909318924, 0.2141617238521576], [-0.1372859627008438, -0.10172691941261292, 0.2134285718202591], [-0.13529232144355774, -0.09527803957462311, 0.20749758183956146], [-0.13696373999118805, -0.09336481988430023, 0.20727060735225677], [-0.13761243224143982, -0.09017187356948853, 0.20825228095054626], [-0.13633911311626434, -0.08527129143476486, 0.2009855955839157], [-0.13820958137512207, -0.08182590454816818, 0.20114023983478546], [-0.14005035161972046, -0.07835695147514343, 0.20124822854995728], [-0.1396554559469223, -0.07370337843894958, 0.19818101823329926], [-0.1416701078414917, -0.0686476081609726, 0.1985664814710617], [-0.13884975016117096, -0.06310748308897018, 0.1922481656074524], [-0.14299258589744568, -0.05908839777112007, 0.19560687243938446], [-0.1457231193780899, -0.05540649965405464, 0.19466707110404968], [-0.1427462249994278, -0.04871055483818054, 0.18848015367984772], [-0.14525234699249268, -0.04517088457942009, 0.18744415044784546], [-0.14078322052955627, -0.04060980677604675, 0.18167687952518463], [-0.14226332306861877, -0.03582405671477318, 0.18153059482574463], [-0.141082301735878, -0.032025545835494995, 0.17802950739860535], [-0.1423020362854004, -0.028848418965935707, 0.1776014119386673], [-0.14609289169311523, -0.024573657661676407, 0.18035677075386047], [-0.13992643356323242, 0.016457168385386467, 0.16556724905967712], [-0.13883064687252045, 0.020845940336585045, 0.16599474847316742], [-0.1385376900434494, 0.025139058008790016, 0.16564449667930603], [-0.14581970870494843, 0.031025530770421028, 0.17435133457183838], [-0.13525894284248352, 0.03301301971077919, 0.16172420978546143], [-0.139143705368042, 0.037256259471178055, 0.16813373565673828], [-0.14115826785564423, 0.04226168245077133, 0.17056801915168762], [-0.13491666316986084, 0.043702226132154465, 0.16477370262145996], [-0.13435538113117218, 0.04781677573919296, 0.1640882045030594], [-0.13571415841579437, 0.05028606206178665, 0.16754385828971863], [-0.13437283039093018, 0.0532618947327137, 0.16770529747009277], [-0.133935809135437, 0.056006528437137604, 0.16715987026691437], [-0.1301489770412445, 0.05789262056350708, 0.16423292458057404], [-0.12968315184116364, 0.06054191663861275, 0.16364510357379913], [-0.12851278483867645, 0.062098756432533264, 0.16398465633392334], [-0.12941715121269226, 0.06615936011075974, 0.16700927913188934], [-0.13149403035640717, 0.0687020868062973, 0.16968943178653717], [-0.13255159556865692, 0.0715581402182579, 0.17301404476165771], [-0.13098183274269104, 0.0745491310954094, 0.17294664680957794], [-0.12967093288898468, 0.07618030160665512, 0.17322345077991486], [-0.13164134323596954, 0.07887272536754608, 0.17585566639900208], [-0.13028867542743683, 0.08052556961774826, 0.1761137843132019], [-0.1278393268585205, 0.0824771523475647, 0.17700336873531342], [-0.12211137264966965, 0.08124474436044693, 0.171152725815773], [-0.12503711879253387, 0.08577623218297958, 0.17743653059005737], [-0.12427228689193726, 0.09058663249015808, 0.1808568686246872], [-0.1227976381778717, 0.09224992990493774, 0.18102332949638367], [-0.12012843787670135, 0.09422897547483444, 0.18179333209991455], [-0.11741188168525696, 0.09620481729507446, 0.18253175914287567], [-0.11464881896972656, 0.09817590564489365, 0.18323726952075958], [-0.11184016615152359, 0.10014070570468903, 0.183908611536026], [-0.10898701846599579, 0.10209760814905167, 0.18454448878765106], [-0.10787808895111084, 0.10579809546470642, 0.18826323747634888], [-0.10662808269262314, 0.10955268889665604, 0.1919630765914917], [-0.10017284005880356, 0.10790479928255081, 0.18622757494449615], [-0.10403081774711609, 0.11584130674600601, 0.19992481172084808], [-0.09599317610263824, 0.11228975653648376, 0.19091956317424774], [-0.0931481122970581, 0.11290392279624939, 0.1919638067483902], [-0.0902566909790039, 0.11350589245557785, 0.192987322807312], [-0.08876629173755646, 0.1159854531288147, 0.1972031444311142], [-0.08725599944591522, 0.11627962440252304, 0.1977033168077469], [-0.08420120179653168, 0.11685705184936523, 0.19868506491184235], [-0.0826568678021431, 0.11714008450508118, 0.19916628301143646], [-0.07823842018842697, 0.11577586084604263, 0.19684679806232452], [-0.07668666541576385, 0.11604239791631699, 0.197299987077713], [-0.07538242638111115, 0.11497266590595245, 0.19842566549777985], [-0.0734141394495964, 0.11739569902420044, 0.20260745286941528], [-0.07039797306060791, 0.11652250587940216, 0.2041758894920349], [-0.07010997831821442, 0.117256298661232, 0.20865263044834137], [-0.06564567983150482, 0.11584242433309555, 0.20613670349121094], [-0.06226608529686928, 0.11628938466310501, 0.20693205296993256], [-0.06001700088381767, 0.11718524247407913, 0.21181583404541016], [-0.05846377834677696, 0.11594356596469879, 0.2129306048154831], [-0.05688928812742233, 0.11467903107404709, 0.21403901278972626], [-0.052633050829172134, 0.10793554782867432, 0.20478875935077667], [-0.052815619856119156, 0.1102830022573471, 0.2127659171819687], [-0.052038274705410004, 0.11074638366699219, 0.21731916069984436], [-0.05037888139486313, 0.10938863456249237, 0.2183951884508133], [-0.048698391765356064, 0.10800723731517792, 0.2194613367319107], [-0.050426993519067764, 0.10985767841339111, 0.227251335978508], [-0.04882172495126724, 0.10674254596233368, 0.22907909750938416], [-0.04702971503138542, 0.10523286461830139, 0.23014996945858002], [-0.04257330670952797, 0.10222547501325607, 0.22792328894138336], [-0.04270745441317558, 0.10055205971002579, 0.22864145040512085], [-0.04152593016624451, 0.10055544227361679, 0.23327870666980743], [-0.042428936809301376, 0.09858153760433197, 0.2383514940738678], [-0.03988881781697273, 0.09542975574731827, 0.2357049286365509], [-0.03867970407009125, 0.09339160472154617, 0.24106401205062866], [-0.03819657117128372, 0.09014742076396942, 0.23805299401283264], [-0.03691605105996132, 0.08791903406381607, 0.243387371301651], [-0.0343790203332901, 0.08480663597583771, 0.24058403074741364], [-0.03196793422102928, 0.07985954731702805, 0.23835280537605286], [-0.0346490740776062, 0.07912406325340271, 0.24247388541698456], [-0.03220907226204872, 0.07417401671409607, 0.24015069007873535], [-0.0323617048561573, 0.07031369209289551, 0.24128873646259308], [-0.030411608517169952, 0.06646892428398132, 0.24262847006320953], [-0.030059410259127617, 0.06151299178600311, 0.23981858789920807], [-0.02809458039700985, 0.0576145239174366, 0.2410220503807068], [-0.03034815937280655, 0.051537979394197464, 0.24212227761745453], [-0.027892019599676132, 0.04675706848502159, 0.23928429186344147], [-0.028847061097621918, 0.04619814082980156, 0.24747754633426666], [-0.028932906687259674, 0.042002927511930466, 0.2482140064239502], [-0.029468942433595657, 0.038368143141269684, 0.25281262397766113], [-0.029540177434682846, 0.03403725475072861, 0.2534237802028656], [-0.029603147879242897, 0.029676752164959908, 0.25396397709846497], [-0.029631482437253, 0.02748650498688221, 0.2542070746421814], [-0.028759244829416275, 0.022370720282197, 0.2467241883277893], [-0.028780469670891762, 0.020232293754816055, 0.24690625071525574], [-0.026672357693314552, 0.01595785655081272, 0.2474556565284729], [-0.027100136503577232, 0.01621379517018795, 0.2514244318008423], [-0.027114149183034897, 0.014026674441993237, 0.2515544295310974], [-0.027992816641926765, 0.009947926737368107, 0.25970637798309326], [-0.029789036139845848, 0.0075586033053696156, 0.25555869936943054], [-0.029332472011446953, 0.005246490705758333, 0.2516418695449829], [-0.029799725860357285, 0.0030988147482275963, 0.2556504011154175], [-0.030264584347605705, -0.001384958392009139, 0.2596384286880493], [-0.029335899278521538, -0.0035389813128858805, 0.25167128443717957], [-0.029787292703986168, -0.008054075762629509, 0.2555437386035919], [-0.030691837891936302, -0.012894744984805584, 0.2633037865161896], [-0.030215423554182053, -0.014956961385905743, 0.25921666622161865], [-0.03110470250248909, -0.02005508542060852, 0.2668457329273224], [-0.03016049973666668, -0.02170456200838089, 0.2587454617023468], [-0.028298495337367058, -0.026605863124132156, 0.26254233717918396], [-0.03097635507583618, -0.03156908228993416, 0.2657446563243866], [-0.030484555289149284, -0.03335040062665939, 0.26152554154396057], [-0.03178958222270012, -0.03953859210014343, 0.2727212905883789], [-0.03216466307640076, -0.04482175037264824, 0.27593910694122314], [-0.03120659664273262, -0.045823268592357635, 0.2677198648452759], [-0.03111305646598339, -0.05034508928656578, 0.2669174075126648], [-0.030608758330345154, -0.05182088911533356, 0.26259106397628784], [-0.03237254545092583, -0.05723088979721069, 0.2777225077152252], [-0.03422868251800537, -0.0586579293012619, 0.2730816602706909], [-0.034652866423130035, -0.061797767877578735, 0.27646586298942566], [-0.034588370472192764, -0.06409117579460144, 0.2759512960910797], [-0.036900296807289124, -0.06630131602287292, 0.27512845396995544], [-0.03682708367705345, -0.06856626272201538, 0.2745825946331024], [-0.037266816943883896, -0.07181008160114288, 0.27786123752593994], [-0.03957802429795265, -0.0739961713552475, 0.2769666612148285], [-0.039492398500442505, -0.07624813914299011, 0.2763674259185791], [-0.03885995224118233, -0.07740052044391632, 0.27194157242774963], [-0.03985805809497833, -0.08182292431592941, 0.2789263129234314], [-0.03985805809497833, -0.08182292431592941, 0.2789263129234314], [-0.04100894182920456, -0.08167318254709244, 0.27037179470062256], [-0.04320439696311951, -0.08853171020746231, 0.2848464250564575], [-0.04091086611151695, -0.08383195847272873, 0.26972517371177673], [-0.040210288017988205, -0.0874578133225441, 0.2813912332057953], [-0.04065113514661789, -0.09089948982000351, 0.28447622060775757]])

corrected_point = KF_filter(points)

velocity_x_1 = (points[200][0] - points[201][0]) / 0.022

velocity_x_2 = (points[201][0] - points[202][0]) / 0.022


velocity_y = (points[200][1] - points[201][1]) / 0.022
velocity_z = (points[200][2] - points[201][2]) / 0.022

print(corrected_point)

